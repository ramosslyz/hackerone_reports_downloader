{
    "id": 670779,
    "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82NzA3Nzk=",
    "url": "https://hackerone.com/reports/670779",
    "title": "Lodash \"difference\" (possibly others) Function Denial of Service Through Unvalidated Input",
    "state": "Closed",
    "substate": "informative",
    "severity_rating": "critical",
    "readable_substate": "Informative",
    "created_at": "2019-08-09T23:22:49.175Z",
    "submitted_at": "2019-08-09T23:22:49.175Z",
    "is_member_of_team?": false,
    "is_organization_group_member?": false,
    "reporter": {
        "disabled": false,
        "username": "spengietz",
        "url": "/spengietz",
        "profile_picture_urls": {
            "small": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
        },
        "is_me?": false,
        "cleared": false,
        "verified": false,
        "hackerone_triager": false,
        "hacker_mediation": false
    },
    "team": {
        "id": 23949,
        "url": "https://hackerone.com/nodejs-ecosystem",
        "handle": "nodejs-ecosystem",
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
            "medium": "https://profile-photos.hackerone-user-content.com/variants/000/023/949/3ea3b2ae039a8f955a4a8fe65d99fe85dc817398_original./5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "permissions": [],
        "submission_state": "disabled",
        "default_currency": "usd",
        "awards_miles": false,
        "offers_bounties": true,
        "state": "public_mode",
        "only_cleared_hackers": false,
        "pentest_feature_enabled?": false,
        "profile": {
            "name": "Node.js third-party modules",
            "twitter_handle": "",
            "website": "https://nodejs.org/en/security/",
            "about": "This program was used to handle vulnerabilities in the Node.js ecosystem."
        }
    },
    "has_bounty?": false,
    "in_validation?": false,
    "can_view_team": true,
    "can_view_report": true,
    "is_external_bug": false,
    "is_published": false,
    "is_participant": false,
    "has_collaborators": false,
    "submitted_by_team_member": false,
    "stage": 4,
    "public": true,
    "visibility": "full",
    "cve_ids": [],
    "singular_disclosure_disabled": true,
    "disclosed_at": "2019-12-04T19:49:06.258Z",
    "bug_reporter_agreed_on_going_public_at": null,
    "team_member_agreed_on_going_public_at": "2019-12-04T19:48:56.407Z",
    "comments_closed?": false,
    "facebook_team?": false,
    "team_private?": false,
    "vulnerability_information": "> NOTE! Thanks for submitting a report! Please replace *all* the [square] sections below with the pertinent details. Remember, the more detail you provide, the easier it is for us to triage and respond quickly, so be sure to take your time filling out the report!\n\nI would like to report a denial of service in Lodash.\nIt allows excessive usage of the NodeJS process's memory, leading to a \"JavaScript heap out of memory\" crash. The same vulnerability exists in the browser version of Lodash and causes Firefox's tab to crash and restart and causes Chrome's tab to completely freeze and become uncloseable (from my testing at least).\n\n# Module\n\n**module name:** Lodash\n**version:** Only tested in 4.17.15\n**npm page:** `https://www.npmjs.com/package/lodash`\n\n## Module Description\n\n> Copy description from npm page\n\nA modern JavaScript utility library delivering modularity, performance & extras.\nThe Lodash library exported as Node.js modules.\n\n## Module Stats\n\n> Replace stats below with numbers from npm’s module page:\n\n24,853,923 downloads in the last week\nI can't find where it lists the daily/monthly downloads\n\n# Vulnerability\n\n## Vulnerability Description\n\n> Description about how the vulnerability was found and how it can be exploited, how it harms package users (data modification/lost, system access, other.\n\nThe vulnerability was discovered while pentesting a web application for a client. The Lodash \"difference\" function (https://github.com/lodash/lodash/blob/4.17.15/lodash.js#L6947) uses the \"baseDifference\" function (https://github.com/lodash/lodash/blob/4.17.15/lodash.js#L2764) to perform what it needs to. \"difference\" is supposed to accept two arrays (`_.difference(array, [values])`) but it does not actually verify whether it is dealing with valid arrays before processing the data. This means a custom malicious Object can be supplied and the function will think it is an array, allowing excessive memory consumption that ends up in a crash of the Node.js process (or crash/freeze of the browser tab in Firefox/Chrome).\n\nIt was found to be exploitable in the clients application because they were passing user-supplied data into the \"difference\" function, which allowed me to crash their application with this vulnerability.\n\n## Steps To Reproduce:\n\n> Detailed steps to reproduce with all required references/steps/commands. If there is any exploit code or reference to the package source code this is the place where it should be put.\n\nBenign example:\n```\nconst _ = require('lodash')\n\nuser_supplied_array = [1, 2, 3]\nvalues_to_compare_to = {'length': 5} // An object with the \"length\" property defined to an integer will be accepted as an array by the _.difference function\n\n_.difference(values_to_compare_to, user_supplied_array) // This will output a new array of length 5 where each value is \"undefined\"\n```\n\nBecause Lodash is essentially creating a new array of the length that we specify in \"values_to_compare_to\", we can provide a large value that will cause the Node.js process to crash before it can successfully create the array.\n\nWill crash Node.js example:\n```\nconst _ = require('lodash')\n\nuser_supplied_array = [1, 2, 3]\nvalues_to_compare_to = {'length': 99999999999} // This could be any huge value\n\n_.difference(values_to_compare_to, user_supplied_array) // The Node.js process will crash, saying that the JavaScript heap ran out of memory\n```\n\nWhen the Node.js process crashes, a stack trace similar to the following is output:\n```\n[5515:0x55aa82652700]    41959 ms: Mark-sweep 580.0 (585.7) -> 580.0 (585.7) MB, 201.8 / 0.0 ms  allocation failure GC in old space requested\n[5515:0x55aa82652700]    42169 ms: Mark-sweep 580.0 (585.7) -> 579.9 (584.2) MB, 209.7 / 0.0 ms  last resort GC in old space requested\n[5515:0x55aa82652700]    42372 ms: Mark-sweep 579.9 (584.2) -> 579.9 (584.2) MB, 203.2 / 0.0 ms  last resort GC in old space requested\n\n\n<--- JS stacktrace --->\n\n==== JS stack trace =========================================\n\nSecurity context: 0x2eaefaca5729 <JSObject>\n    1: baseDifference [/root/temp/tmp/node_modules/lodash/lodash.js:~2764] [pc=0x11aea9f0d272](this=0x28b6ba70c0f9 <JSGlobal Object>,array=0x3dd3a43ca4c9 <Object map = 0x1294fe65a571>,values=0x3dd3a43ca4a9 <JSArray[2]>,iteratee=0x3dd3a43822d1 <undefined>,comparator=0x3dd3a43822d1 <undefined>)\n    2: arguments adaptor frame: 2->4\n    3: /* anonymous */ [/root/temp/tmp/node_modules/lodash/lodash.j...\n\nFATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - JavaScript heap out of memory\n 1: node::Abort() [node]\n 2: 0x55aa808c347e [node]\n 3: v8::Utils::ReportOOMFailure(char const*, bool) [node]\n 4: v8::internal::V8::FatalProcessOutOfMemory(char const*, bool) [node]\n 5: v8::internal::Factory::NewUninitializedFixedArray(int) [node]\n 6: 0x55aa80448b1d [node]\n 7: v8::internal::Runtime_GrowArrayElements(int, v8::internal::Object**, v8::internal::Isolate*) [node]\n 8: 0x11aea9d842fd\nAborted\n```\n\n\n## Patch\n\n> If you're able to provide a patch with the fix please post it in this section\n\nI don't know specifically, but it seems that proper verification that both inputs are arrays would fix this.\n\n## Supporting Material/References:\n\n> State all technical information about the stack where the vulnerability was found\n\nTested on two separate operating systems with the same end results.\nWindows:\n- Windows 10\n- Node.js v8.9.4\n- npm version 5.6.0\n- Firefox 68.01 and Chrome 76.0.3809.100 when testing the browser version of Lodash\n\nLinux:\n- Kali Linux\n- Node.js v9.0.0\n- npm version 6.1.0\n- Did not test in Firefox/Chrome on this operating system\n\n# Wrap up\n\n> Select Y or N for the following statements:\n\n- I contacted the maintainer to let them know: N, it said to report it here\n- I opened an issue in the related repository: N, it said not to publicly disclose it until after\n\n## Impact\n\nAn attacker could cause excessive resource consumption which could slow down the server for other users or they could cause an outright crash of the Node.js process, denying service to all users of the application.",
    "weakness": {
        "id": 48,
        "name": "Denial of Service"
    },
    "original_report_id": null,
    "original_report_url": null,
    "attachments": [],
    "allow_singular_disclosure_at": null,
    "vote_count": 6,
    "voters": [
        "macasun",
        "eveeez",
        "0x08",
        "pewpewpew-soul",
        "yoflow",
        "cykich"
    ],
    "severity": {
        "rating": "critical",
        "score": 9.3,
        "author_type": "Team",
        "metrics": {
            "attack_vector": "network",
            "attack_complexity": "low",
            "privileges_required": "none",
            "user_interaction": "none",
            "scope": "unchanged",
            "confidentiality": "none",
            "integrity": "none",
            "availability": "high"
        }
    },
    "structured_scope": {
        "databaseId": 5914,
        "asset_type": "SOURCE_CODE",
        "asset_identifier": "lodash",
        "max_severity": "critical"
    },
    "abilities": {
        "assignable_team_members": [],
        "assignable_team_member_groups": []
    },
    "activities": [
        {
            "id": 5542161,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": ">To help us escalate this report as quickly as possible, please take a moment to confirm your report addresses:\n\n**Reproducible:** I included example code to crash the Node.js process\n**Impact:** I demonstrated and described the impact of slowing down the server and/or crashing it completely.\n**In Scope:** Lodash is listed as in-scope\n\nThanks!",
            "automated_response": false,
            "created_at": "2019-08-09T23:26:34.870Z",
            "updated_at": "2019-08-09T23:26:34.870Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5542180,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "I forgot to include that this likely affects more than just the \"difference\" function because the vulnerability lies within the \"baseDifference\" function, meaning that other Lodash methods that use that function might be vulnerable to this denial of service as well.",
            "automated_response": false,
            "created_at": "2019-08-09T23:34:17.293Z",
            "updated_at": "2019-08-09T23:34:17.293Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5556575,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Hi @spengietz \n\nThank you for your submission. Your report is currently being reviewed and the HackerOne triage team will get back to you once there is additional information to share.\n\nThanks, \n@ktistai",
            "automated_response": false,
            "created_at": "2019-08-12T14:37:06.603Z",
            "updated_at": "2019-08-12T14:37:06.603Z",
            "actor": {
                "username": "ktistai",
                "cleared": false,
                "verified": false,
                "url": "/ktistai",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5557615,
            "is_internal": false,
            "editable": false,
            "type": "Activities::BugTriaged",
            "message": "Hello @spengietz \n\nThank you for your submission! We were able to validate your report, and have submitted it to the appropriate remediation team for review. They will let us know the final ruling on this report, and when/if a fix will be implemented. Please note that the status and severity are subject to change.\n\nRegards,\n@ktistai",
            "automated_response": false,
            "created_at": "2019-08-12T17:06:38.128Z",
            "updated_at": "2019-08-12T17:06:38.128Z",
            "actor": {
                "username": "ktistai",
                "cleared": false,
                "verified": false,
                "url": "/ktistai",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/322/520/01cd21dce301646646276fd9125cffd448fbffd6_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5669459,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Hi there, just wanted to check in and see if there were any updates here. Thanks!",
            "automated_response": false,
            "created_at": "2019-08-26T21:02:25.771Z",
            "updated_at": "2019-08-26T21:02:25.771Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5763922,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Hey, just wanted to check in here again. Thank you!",
            "automated_response": false,
            "created_at": "2019-09-09T17:09:05.282Z",
            "updated_at": "2019-09-09T17:09:05.282Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5955233,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Hi @spengietz,\n\nThanks a lot for reporting the vulnerability.\nI invited John Dalton, maintainer of lodash, to review and help us resolve the issue here.",
            "automated_response": false,
            "created_at": "2019-10-03T22:29:27.411Z",
            "updated_at": "2019-10-03T22:29:27.411Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5955241,
            "is_internal": false,
            "editable": false,
            "type": "Activities::ReportSeverityUpdated",
            "message": "",
            "automated_response": false,
            "created_at": "2019-10-03T22:31:21.500Z",
            "updated_at": "2019-10-03T22:31:21.500Z",
            "additional_data": {
                "old_severity": "High",
                "new_severity": "Critical (9.3)",
                "old_severity_id": 489415,
                "new_severity_id": 530904
            },
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5955242,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "@spengietz could you also see if I got the CVSS score right for this report in your opinion?",
            "automated_response": false,
            "created_at": "2019-10-03T22:31:40.847Z",
            "updated_at": "2019-10-03T22:31:40.847Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5955341,
            "is_internal": false,
            "editable": false,
            "type": "Activities::ExternalUserJoined",
            "message": "",
            "automated_response": false,
            "created_at": "2019-10-03T23:11:14.616Z",
            "updated_at": "2019-10-03T23:11:14.616Z",
            "actor": {
                "username": "jdalton",
                "cleared": false,
                "verified": false,
                "url": "/jdalton",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5955386,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Perfect, thanks @lirantal and @jdalton! Let me know if you have any questions",
            "automated_response": false,
            "created_at": "2019-10-03T23:23:10.231Z",
            "updated_at": "2019-10-03T23:23:10.231Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5955406,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Whoops I misread your message.\nI just tried calculating the CVSS and came out with an 8.6 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H), but I don't work with CVSS rankings typically so I may be off on a switch or two there.",
            "automated_response": false,
            "created_at": "2019-10-03T23:31:00.834Z",
            "updated_at": "2019-10-03T23:31:45.824Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5959342,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "The difference with both of our scores is the Scope. Why do you feel it is changed? \nFor example, the vulnerable component is Node.js and the affected component is Node.js too.",
            "automated_response": false,
            "created_at": "2019-10-04T13:44:28.122Z",
            "updated_at": "2019-10-04T13:44:28.122Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5959739,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "I was thinking that Lodash was the vulnerable component and that Node.js was the affected component, but maybe they are considered one of the same in this context",
            "automated_response": false,
            "created_at": "2019-10-04T14:25:29.952Z",
            "updated_at": "2019-10-04T14:25:29.952Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5959804,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "if that was the case then vulnerable component would never be equal to impacted component. The vulnerability lies in the lodash library which puts the browser or the Node.js server as a vulnerable component as they are using it. ",
            "automated_response": false,
            "created_at": "2019-10-04T14:34:33.112Z",
            "updated_at": "2019-10-04T14:34:33.112Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5960510,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Oh alright that makes sense, then I think your analysis is accurate",
            "automated_response": false,
            "created_at": "2019-10-04T16:07:14.803Z",
            "updated_at": "2019-10-04T16:07:14.803Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5962264,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Great, thanks for confirming.\n\n@jdalton let us know if you need any help with resolving the issue.\n@spengietz any chance you can help out John with figuring out other places that this occurs in the codebase?\n",
            "automated_response": false,
            "created_at": "2019-10-04T20:11:27.604Z",
            "updated_at": "2019-10-04T20:11:27.604Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5962756,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Just did a quick search in the lodash.js file (https://github.com/lodash/lodash/blob/4.17.15/lodash.js) to see what functions are relying on \"baseDifference\". Not sure if it might be imported and used elsewhere in the code though.\n\nThe functions that use baseDifference within lodash.js are here:\n- difference\n- differenceBy\n- differenceWith\n- baseXor\n- without\n\nNot sure about the exploitability if each of them, but possibly next week or next weekend I could look into that.",
            "automated_response": false,
            "created_at": "2019-10-04T21:07:23.002Z",
            "updated_at": "2019-10-04T21:07:23.002Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5963420,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Several of our methods are \"Collections\" methods meaning they accept an array-like object (an object with a length counts too). Many builtin array methods can accept things like this too.\n```js\nArray.prototype.forEach.call({'length': 99999999999}, () =>{}) // hang\n```\n\nMany bultin array methods tend to be `this` generic so they don't care that an object is not a real array either. I'm open to ideas to tackle it though.",
            "automated_response": false,
            "created_at": "2019-10-05T01:42:34.864Z",
            "updated_at": "2019-10-05T01:42:34.864Z",
            "actor": {
                "username": "jdalton",
                "cleared": false,
                "verified": false,
                "url": "/jdalton",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5978700,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Ah that's interesting, didn't realize that. This seems like a tough problem to tackle then and I haven't worked intimately with Node.js for a while now so I don't have many insights. I'll keep thinking on it though and see if I can do some research tonight into what a good direction to go would be.",
            "automated_response": false,
            "created_at": "2019-10-07T16:41:01.618Z",
            "updated_at": "2019-10-07T16:41:01.618Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5985347,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "@jdalton I see your point about this being perhaps a generic enough issue that it could be thought of \"this is how it works in the language\", and surely enough we will not consider the Array forEach example you demonstrated as a vulnerability. However, a user may consider lodash's methods to not work in the same way, and they wouldn't have your depth of knowledge for this.\n\nWhat I think will be best here is to have a security disclaimer in lodash's documentation/repository which will make users aware of this security concern. WDYT?",
            "automated_response": false,
            "created_at": "2019-10-08T12:04:36.079Z",
            "updated_at": "2019-10-08T12:04:36.079Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5987906,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Improved docs is always a win for me :) ",
            "automated_response": false,
            "created_at": "2019-10-08T16:50:22.982Z",
            "updated_at": "2019-10-08T16:50:22.982Z",
            "actor": {
                "username": "jdalton",
                "cleared": false,
                "verified": false,
                "url": "/jdalton",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/237/124/03f44e2935a9cb266645e0eef4065316affe0241_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5989005,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "@jdalton yay 🤗❤️\n@spengietz WDYT?\n",
            "automated_response": false,
            "created_at": "2019-10-08T19:10:22.169Z",
            "updated_at": "2019-10-08T19:10:22.169Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 5989733,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "I think that works.\n\nDo you know why the Array.prototype version above just hangs forever when the Lodash function actually crashes the node process? Not sure if that differentiates them, but it seems like a payload against Array.prototype would only affect the user who sent it, but an actual crash of the process would affect every user",
            "automated_response": false,
            "created_at": "2019-10-08T20:42:31.604Z",
            "updated_at": "2019-10-08T20:42:31.604Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 6026710,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "@jdalton ping me when you make an update to the README then and I'll close this issue?\n\n@spengietz I'm not entirely sure but I can assume that perhaps lodash just straight-up tries to allocate more data on the heap than it was allowed and so it crashed on OOM where-as the language Array construct does it different by perhaps trying to allocate when memory is available only and so it may hang but not crash. That's just a guess though, I haven't looked into the inner workings of either.",
            "automated_response": false,
            "created_at": "2019-10-13T10:05:28.381Z",
            "updated_at": "2019-10-13T10:05:28.381Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 6036399,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Given that, it seems like the two scenarios aren't very comparable then.\n\nIf I exploited the Array.prototype example above in a web application, it would just take a long time to respond to my request and not affect any other users (as far as I understand at least).\n\nIf I exploited the Lodash version that I reported, the entire server would crash and would deny access to every user of the application indefinitely.\n\nSeems like these aren't quite the same and maybe a documentation change is not quite enough. Perhaps I'm wrong on the impact, but it seems that in Lodash the impact is far greater than the built-in JS methods.",
            "automated_response": false,
            "created_at": "2019-10-14T16:58:30.935Z",
            "updated_at": "2019-10-14T16:59:04.038Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 6057237,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "I wish I had more in-depth knowledge of Node.js internals to help come up with a better fix/solution, but I'm not sure I can.\n\nThis may not be applicable, but in Python the len() function provides the length of something, instead of relying on a .length attribute, so I wonder if there is some way to check in JavaScript if you're reading the value of the key \"length\" or if you're actually reading the length of the object/array.",
            "automated_response": false,
            "created_at": "2019-10-16T16:48:33.614Z",
            "updated_at": "2019-10-16T16:48:33.614Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 6058139,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "@spengietz are we discussing the internal Node.js (or rather v8 actually) API and its security? if so that's a whole different context than this H1 program which is focused on npm ecosystem modules.\n\n@jdalton could lodash run some checks internally like checking hasOwnProperty or would that not matter? I guess even if you add it then it will be a breaking change for library consumers.",
            "automated_response": false,
            "created_at": "2019-10-16T19:08:07.013Z",
            "updated_at": "2019-10-16T19:08:07.013Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 6058622,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "I was just making the comparison because the impact of the v8 API versus the Lodash vuln I reported makes me think that additional documentation may not be enough to mitigate the risk that it presents, I just don't know exactly what a sufficient fix would look like in Lodash",
            "automated_response": false,
            "created_at": "2019-10-16T20:07:19.497Z",
            "updated_at": "2019-10-16T20:07:19.497Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 6143252,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "I think that a documentation update is required regardless to ensure developers are aware of the security context. \n\n@spengietz I believe this vulnerability applies to consumers of lodash that may use this \"insecure\" compare function and may get tricked into passing arbitrary sizes via objects to the function call. I'm not yet entirely convinced this is a vulnerability per-the-docs in lodash as you could generally consider C's malloc(size) as vulnerable as well since you can pass a large enough size and crash an app. I do agree however that a security disclaimer needs to be added by @jdalton to ensure developers are aware of the potential security issue.",
            "automated_response": false,
            "created_at": "2019-10-26T08:40:52.713Z",
            "updated_at": "2019-10-26T08:40:52.713Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 6157697,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Yeah that's a good point on malloc. It's not a vulnerability in the function, it's a vulnerability in incorrectly using the function.\n\nAlright I'm on board with that then!",
            "automated_response": false,
            "created_at": "2019-10-28T18:59:09.302Z",
            "updated_at": "2019-10-28T18:59:09.302Z",
            "actor": {
                "username": "spengietz",
                "cleared": false,
                "verified": false,
                "url": "/spengietz",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 6468650,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "@spengietz I will close the issue as informative and disclose so we can retain the action items from this and make it available for lodash maintainers and community to follow-up with a PR for this later.",
            "automated_response": false,
            "created_at": "2019-12-04T19:48:00.164Z",
            "updated_at": "2019-12-04T19:48:00.164Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 6468653,
            "is_internal": false,
            "editable": false,
            "type": "Activities::BugInformative",
            "message": "A security disclaimer should be added to the project for developers to be aware",
            "automated_response": false,
            "created_at": "2019-12-04T19:48:35.565Z",
            "updated_at": "2019-12-04T19:48:35.565Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 6468655,
            "is_internal": false,
            "editable": false,
            "type": "Activities::AgreedOnGoingPublic",
            "message": "",
            "automated_response": false,
            "created_at": "2019-12-04T19:48:56.428Z",
            "updated_at": "2019-12-04T19:48:56.428Z",
            "first_to_agree": true,
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        },
        {
            "id": 6468657,
            "is_internal": false,
            "editable": false,
            "type": "Activities::ManuallyDisclosed",
            "message": "",
            "automated_response": false,
            "created_at": "2019-12-04T19:49:06.147Z",
            "updated_at": "2019-12-04T19:49:06.147Z",
            "actor": {
                "username": "lirantal",
                "cleared": false,
                "verified": false,
                "url": "/lirantal",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/096/045/7e9d9170c9862d8d3697b11b0bb7160d40444c16_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "nodejs-ecosystem"
        }
    ],
    "activity_page_count": 1,
    "activity_page_number": 1,
    "summaries": [
        {
            "category": "team",
            "can_view?": true,
            "can_create?": false
        },
        {
            "category": "researcher",
            "can_view?": true,
            "can_create?": false
        }
    ]
}