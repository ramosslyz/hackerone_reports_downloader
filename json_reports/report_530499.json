{
    "id": 530499,
    "global_id": "Z2lkOi8vaGFja2Vyb25lL1JlcG9ydC81MzA0OTk=",
    "url": "https://hackerone.com/reports/530499",
    "title": "WooCommerce: Persistent XSS via customer address (state/county)",
    "state": "Closed",
    "substate": "resolved",
    "severity_rating": "high",
    "readable_substate": "Resolved",
    "created_at": "2019-04-07T09:06:52.809Z",
    "submitted_at": "2019-04-07T09:06:52.809Z",
    "is_member_of_team?": false,
    "is_organization_group_member?": false,
    "reporter": {
        "disabled": false,
        "username": "foobar7",
        "url": "/foobar7",
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98"
        },
        "is_me?": false,
        "cleared": true,
        "verified": true,
        "hackerone_triager": false,
        "hacker_mediation": false
    },
    "team": {
        "id": 111,
        "url": "https://hackerone.com/automattic",
        "handle": "automattic",
        "profile_picture_urls": {
            "small": "https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/d3dc6b2d7e2dc3657e8861b0d7e2dfca1a6d513dd784c613f4e56738907cea98",
            "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
        },
        "permissions": [],
        "submission_state": "open",
        "default_currency": "usd",
        "awards_miles": false,
        "offers_bounties": true,
        "state": "public_mode",
        "only_cleared_hackers": false,
        "pentest_feature_enabled?": false,
        "profile": {
            "name": "Automattic",
            "twitter_handle": "",
            "website": "https://automattic.com",
            "about": "WordPress.com, VaultPress, Akismet, Gravatar, WooCommerce, Polldaddy, Tumblr and more!"
        }
    },
    "has_bounty?": true,
    "in_validation?": false,
    "can_view_team": true,
    "can_view_report": true,
    "is_external_bug": false,
    "is_published": false,
    "is_participant": false,
    "has_collaborators": false,
    "submitted_by_team_member": false,
    "stage": 4,
    "public": true,
    "visibility": "full",
    "cve_ids": [],
    "singular_disclosure_disabled": true,
    "disclosed_at": "2019-05-26T08:35:50.322Z",
    "bug_reporter_agreed_on_going_public_at": "2019-04-26T08:35:48.875Z",
    "team_member_agreed_on_going_public_at": null,
    "comments_closed?": false,
    "facebook_team?": false,
    "team_private?": false,
    "vulnerability_information": "Persistent XSS via customer address (state/county)\n================================\n\nCVSS\n----\n\nHigh 7.2 [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N)\n\nDescription\n-----------\n\nThe current version (3.5.7) of the WooCommerce WordPress plugin echoes the state/county of a customer in the admin backend without encoding, leading to persistent XSS.\n\nFor a successful attack, an attacker needs a customer account, though it is to be expected that account creation is available for users in a considerable amount of setups.\n\nIf the victim is an administrator on a default WordPress setup, an attacker can exploit the issue to gain code execution on the server by eg sending a request to edit a WordPress plugin file.\n\nPOC\n---\n\nSetup: Install the WooCommerce plugin & open registration / add a user (permissions do not matter, I used \"customer\"). \n\nTo place the payload:\n\n1. Login as a customer at http://192.168.0.101/wordpress/my-account/\n2. To place a payload, either:\n    - add an item to cart & proceed to checkout. Under \"Billing Details\", select UK as country and enter `'\"><img src=x onerror=alert(1) x=y` as `County` (note the missing `>` which is required as tags are filtered).\n    - Alternatively, simply change the address under account settings at `http://192.168.0.101/wordpress/my-account/edit-address/`.\n\nTo trigger the payload:\n\n1. Go to `http://192.168.0.101/wordpress/wp-admin/users.php` and click on the customer, or directly visit `http://192.168.0.101/wordpress/wp-admin/user-edit.php?user_id=4`, where `4` is the customers ID.\n\n## Impact\n\nWith a successful attack, an attacker can read data available to the attacked user or perform arbitrary request in the name of the attacked user. \n\nWith a default setup, an attacker can gain code execution on the server by eg editing a WordPress plugin file.",
    "weakness": {
        "id": 62,
        "name": "Cross-site Scripting (XSS) - Stored"
    },
    "original_report_id": null,
    "original_report_url": null,
    "attachments": [
        {
            "id": 463897,
            "file_name": "xss.png",
            "expiring_url": "https://hackerone-us-west-2-production-attachments.s3.us-west-2.amazonaws.com/000/463/897/164bf771a0f5417aabc88070a2d4b40f2019112e/xss.png?response-content-disposition=attachment%3B%20filename%3D%22xss.png%22%3B%20filename%2A%3DUTF-8%27%27xss.png&response-content-type=image%2Fpng&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=ASIAQGK6FURQ44TLZFA6%2F20230829%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230829T073307Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjENf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLXdlc3QtMiJHMEUCIQCm8A5VicKSFdKk4pT1CD%2B9aD8whwsKjbgyswTJtjuCwwIgbQkNA5LWAijPuPYCLq2qw1BsS6Km0Nr%2BSAzJkxT%2F5rAquwUIoP%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARADGgwwMTM2MTkyNzQ4NDkiDAUh5bnfX42OeHzAHCqPBUk2d8HAsYNgcRvKeT%2Ftc%2FDmhEt%2BerxJO7sajeYJjcelj5odT9W%2BTjlYl%2FmZpvLn2NiyiCQF9Wk4UHySsA0Oh4Uy6pfeocYAP0EKkS1IkVCEN4YmtMmlZyEn0SMPDogzrH%2B4Ed7VuR54IPkzn2euwtWjhFaoiB2RLVqGBd%2B3e%2BLlXfdpHvvGfAAJ83tKHpZ1yhkO4u%2B2kTkemBBR4lSYuCVoWFlhWFlkmAVIkqUlvhoH5GuaCdNomHfYVz%2BbqDpMHPZrvySz7mACWoEt4Qwrs8Gyc%2BkTdPZaB%2F46k9vOi0Lko2Zc5Pt7N1%2FpAzZKupnNrcebhhPktqHvghxuPXdBkaa6NywOX8Mj7J3vmJYUPDMjNLY9RL9TloFCSyL%2BH7e9vgnNVP7WFvFBgt3yUqy6VR%2BVwCsXW9rXX5iUoiQr952qwjX%2BCBjmbl50%2BefXi3eA6h%2FrW8sbQNY8ZLGU3811e6J6ZxIcsGKFT6%2BNe1mlCEvaagQVBSwgft9Qvw5G933uZkkIIRrecVrrxV1Kdyf18UuksHfwWvoPsxTVqLghh1fsH9QzD5tW58%2FuV%2BDHNjcO0Y7MfQZYf%2F1KIm3T12pyBS%2BByAc4M%2B4H%2BznSX1O17idlgZ4aptmYnQdIAYPd1qvB9lGCmmvvyGrknfkQaumBhDcQRGSxQFRN7cUVHj1ZxM08uZpmvLxXBbtA%2BhkRMuKZUZROk8poKap2OCWR%2Fr5QTQpIvE0RO0BqlOYwF8g6GjE%2BJfumo%2B%2BP2Uarii4%2Bi4%2BnE6cXCeTiqSJSit9AKwwjsJnpBl2IgfTN1pfXYi5HjCgmBb3PWeFvRjFiLm8dOZgU7wZl749NK%2F25A2jO3VQqu5SUZmK0%2B89WyBYfPCX8vU4wlrC2pwY6sQGYpjFrGNKqUhFm3ihi0%2Fxb68dwJpw2ByqbkEntVKLgVrut%2FErgh8ywfClfdrPrYCeAtSFYHBUVlsWTASBv82isMRBVL%2BvEfK0fjMoUXbiSGB9RIsWYEaAFc2AlCy%2F7ArBadwZY9ywlDeeztTmEKiauvWxW%2FbQ7z5x5fmIylqk1nm%2Fr%2BPnkssGbY5t572aOr%2B1M2PUkmomm8AQ%2FOb5Mm0Wx0dRE01Xqm0W4DAD%2F9JIWsTA%3D&X-Amz-SignedHeaders=host&X-Amz-Signature=1d91eea1b3b738d4c2374d6b53d338a2d9d8e28e7ef20e58171b61bc8600e07d",
            "file_size": 49837,
            "type": "image/png"
        }
    ],
    "allow_singular_disclosure_at": "2019-05-26T08:35:48.944Z",
    "allow_singular_disclosure_after": -134434638.5607332,
    "singular_disclosure_allowed": true,
    "vote_count": 40,
    "voters": [
        "vavkamil",
        "sameerphad72",
        "zikads",
        "savitar0x01",
        "michan",
        "javo",
        "yinvi777",
        "ecx",
        "roguesmg",
        "cryptographer",
        "and 30 more..."
    ],
    "severity": {
        "rating": "high",
        "author_type": "User"
    },
    "structured_scope": null,
    "abilities": {
        "assignable_team_members": [],
        "assignable_team_member_groups": []
    },
    "activities": [
        {
            "id": 4501443,
            "is_internal": false,
            "editable": false,
            "type": "Activities::ReportTitleUpdated",
            "message": "",
            "automated_response": false,
            "created_at": "2019-04-07T09:07:12.250Z",
            "updated_at": "2019-04-07T09:07:12.250Z",
            "additional_data": {
                "old_title": "Persistent XSS via customer address (state/county)",
                "new_title": "WooCommerce: Persistent XSS via customer address (state/county)"
            },
            "actor": {
                "username": "foobar7",
                "cleared": true,
                "verified": true,
                "url": "/foobar7",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "automattic"
        },
        {
            "id": 4502119,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "The option to open registration up can be found at WooCommerce -> Settings -> Accounts & Privacy -> \"Allow customers to create an account [during checkout / on the My account page]\"\n\nThe origin of the vulnerability is in the `change_country` function in `/assets/js/admin/users.js`, which reads the properly encoded state/county value out of the DOM, and then reinserts it in an insecure manner.\n\nThe insecure insertion takes place in line 64:\n\n>     $state.replaceWith( '<input type=\"text\" class=\"js_field-state\" name=\"' + input_name + '\" id=\"' + input_id + '\" value=\"' + value + '\" />' );\n\nwhere `value` is the user-controlled state/county name. \n\nThe issue can be fixed by encoding quotes in the line:\n\n    $state.replaceWith( '<input type=\"text\" class=\"js_field-state\" name=\"' + input_name + '\" id=\"' + input_id + '\" value=\"' + value.replace(/\"/g, \"&quot;\") + '\" />' );\n\nThe fix would have to be applied to the minified version of the script.",
            "automated_response": false,
            "created_at": "2019-04-07T13:25:00.273Z",
            "updated_at": "2019-04-07T13:25:00.273Z",
            "actor": {
                "username": "foobar7",
                "cleared": true,
                "verified": true,
                "url": "/foobar7",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "automattic"
        },
        {
            "id": 4504997,
            "is_internal": false,
            "editable": false,
            "type": "Activities::Comment",
            "message": "Hi. Thanks for the report. We are going to take a look.",
            "automated_response": false,
            "created_at": "2019-04-08T07:52:59.920Z",
            "updated_at": "2019-04-08T07:52:59.920Z",
            "actor": {
                "username": "xknown",
                "cleared": false,
                "verified": false,
                "url": "/xknown",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "automattic"
        },
        {
            "id": 4528380,
            "is_internal": false,
            "editable": false,
            "type": "Activities::BugTriaged",
            "message": "",
            "automated_response": false,
            "created_at": "2019-04-10T09:55:52.914Z",
            "updated_at": "2019-04-10T09:55:52.914Z",
            "actor": {
                "username": "xknown",
                "cleared": false,
                "verified": false,
                "url": "/xknown",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "automattic"
        },
        {
            "id": 4641494,
            "is_internal": false,
            "editable": false,
            "type": "Activities::BugResolved",
            "message": "Hi. This issue was fixed as part of the 3.5.8 release.",
            "automated_response": false,
            "created_at": "2019-04-25T13:14:40.130Z",
            "updated_at": "2019-04-25T13:14:40.130Z",
            "actor": {
                "username": "xknown",
                "cleared": false,
                "verified": false,
                "url": "/xknown",
                "profile_picture_urls": {
                    "medium": "/assets/avatars/default-25f7248a18bdf9e2dc8310319b148d66cff430fa0fade6c5f25fee1b8d7f27ed.png"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "reporter": {
                "username": "foobar7",
                "url": "/foobar7"
            },
            "genius_execution_id": null,
            "team_handle": "automattic"
        },
        {
            "id": 4641496,
            "is_internal": false,
            "editable": false,
            "type": "Activities::BountyAwarded",
            "message": "",
            "automated_response": false,
            "created_at": "2019-04-25T13:14:57.085Z",
            "updated_at": "2019-04-25T13:14:57.085Z",
            "actor": {
                "url": "/automattic",
                "ibb": false,
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
                },
                "profile": {
                    "name": "Automattic"
                }
            },
            "bounty_currency": "usd",
            "genius_execution_id": null,
            "team_handle": "automattic",
            "collaborator": {
                "username": "foobar7",
                "url": "/foobar7"
            }
        },
        {
            "id": 4646455,
            "is_internal": false,
            "editable": false,
            "type": "Activities::AgreedOnGoingPublic",
            "message": "thanks for the bounty! \n\nIs disclosure OK with you?",
            "automated_response": false,
            "created_at": "2019-04-26T08:35:48.896Z",
            "updated_at": "2019-04-26T08:35:48.896Z",
            "first_to_agree": true,
            "actor": {
                "username": "foobar7",
                "cleared": true,
                "verified": true,
                "url": "/foobar7",
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/197/817/efb62be6777043aba724654aa495ebeccabb9e72_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
                },
                "hackerone_triager": false,
                "hackerone_employee": false
            },
            "genius_execution_id": null,
            "team_handle": "automattic"
        },
        {
            "id": 4925882,
            "is_internal": false,
            "editable": false,
            "type": "Activities::ReportBecamePublic",
            "message": "",
            "automated_response": false,
            "created_at": "2019-05-26T08:35:50.347Z",
            "updated_at": "2019-05-26T08:35:50.347Z",
            "actor": {
                "url": "/automattic",
                "ibb": false,
                "profile_picture_urls": {
                    "medium": "https://profile-photos.hackerone-user-content.com/variants/000/000/111/7f89e1ea233f92916202521a069fdbfe9eced339_original.png/5136ed9b2fa7c4d4abbf39fb971047c62d98ec4740a88eb55d7e26373250a937"
                },
                "profile": {
                    "name": "Automattic"
                }
            },
            "genius_execution_id": null,
            "team_handle": "automattic"
        }
    ],
    "activity_page_count": 1,
    "activity_page_number": 1,
    "summaries": [
        {
            "category": "team",
            "can_view?": true,
            "can_create?": false
        },
        {
            "category": "researcher",
            "can_view?": true,
            "can_create?": false
        }
    ]
}